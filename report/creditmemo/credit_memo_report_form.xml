<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<#assign memo = record.custpage_result?eval>
<pdfset>
<#list memo.copy as docs>
<pdf>
<head>
  <link name="NotoSansThai" type="font" subtype="opentype" src="${nsfont.NotoSansThai_Regular}" src-bold="${nsfont.NotoSansThai_Bold}" bytes="2" />
    <macrolist>
        <macro id="nlheader">
            <table class="header" style="width: 100%;">
                <tr>
                    <td>
                        <#if subsidiary.logo?length != 0>
                            <img src="${subsidiary.logo@url}" style="float: left; width: 150px; height: 100px;"/>
                        </#if>
                    </td>
                    <td align="right">
                      <div class="box" height="50px">
                        <div class="box1" corner-radius="200px">
                          <p><b>ใบลดหนี้/<br/>ใบคืนสินค้า</b></p>
                        </div>
                        <div class="box2"></div>
                        <div class="box3"></div>
                      </div> 
                    </td>
                </tr>
              <tr>
                    <td align="left" colspan="2"><span class="number">${memo.legalName}</span></td>
                </tr>
              <tr>
                    <td align="left" colspan="2"><span class="number">${memo.addr1} ${memo.addr2} ${memo.city} ${memo.state} ${memo.zip}</span></td>
                </tr>
                <tr>
                    <td align="left" colspan="2">โทร : ${memo.tel} อีเมล์ : ${memo.mail}</td>
                </tr>
              <tr>
                    <td align="left" colspan="2">เลขที่ประจำตัวผู้เสียภาษี : ${memo.taxid} สาขาที่ : ${memo.branchcode}</td>
                </tr>
              <tr>
                    <td></td>
                    <td align="right" padding-right="70px"><b><#if docs.original == "ต้นฉบับ">ต้นฉบับ<#else>สำเนา</#if> (สำหรับลูกค้า)</b></td>
                </tr>
            </table>
        </macro>
        <macro id="nlfooter">
            <table class="footer" style="width: 100%;">
                <tr>
                    <td align="right">
                        <pagenumber/> of <totalpages/>
                    </td>
                </tr>
            </table>
        </macro>
    </macrolist>
    <style>
		* {
			font-family: NotoSansThai, sans-serif;
		}
		table {
			font-size: 9pt;
			table-layout: fixed;
		}
      .box {
        position: relative;
        height: 1cm;
      }
      .box1 {
        z-index: 0;
        top: -3cm;
        left: -5cm;
        background-color: red;
        border: none;
        width:  5cm;
        height: 5cm;
        position: absolute;
      }
      .box1 p {
        vertical-align: bottom;
        padding-bottom: 10px;
        align: center;
      }
      .box2 {
        background-color: #fff;
        top: -2cm;
        left: -5cm;
        z-index: 100;
        width:  5cm;
        height: 2cm;
        position: absolute;
      }
      .box3 {
        background-color: #fff;
        z-index: -100;
        top:  -1cm;
        left: -0.5cm;
        width:  .5cm;
        height: 3cm;
        position: absolute;
      }
      label {
          display: inline;
      }
      input[type=checkbox] {
          display: inline;
      }
    </style>
</head>
<body header="nlheader" header-height="19%" footer="nlfooter" footer-height="20pt" padding="0.5in 0.5in 0.5in 0.5in" size="A4">
  <!-- <circle x="0" y="50%" radius="40%" background="red" border="none" top="0" right="0" z-index="-1"/> -->
    <table style="width: 100%; margin-top: 10px;">
        <tr>
            <td width="60%" corner-radius="5px" border="1px">
              <table>
                <tr>
                  <td colspan="2">ลูกค้า : <#if memo.actname != "">00000<#else>${memo.customernumber}</#if></td>
                </tr>
                <tr>
                  <td colspan="2">บริษัท : <#if memo.actname != "">${memo.actname}<#else>${memo.customercompany}</#if></td>
                </tr>
                <tr>
                  <td colspan="2">ที่อยู่ : <#if memo.customerActAddr1 != "" ||  memo.customerActAddr2 != "" ||  memo.customerActZip != "">${memo.customerActAddr1}${memo.customerActAddr2}${memo.customerActZip}<#else>${memo.customerAddr1}${memo.customerAddr2}${memo.customerCity}${memo.customerState}${memo.customerZip}</#if></td>
                </tr>
                <tr>
                  <td colspan="2">โทรศัพท์/Tel. ${memo.customertel} FAX: ${memo.customerfax} </td>
                </tr>
                <tr>
                  <td>เลขประจำตัวผู้เสียภาษี : ${memo.customertaxid}</td>
                  <td style="vertical-align: middle;">
                  <#if memo.hq != "false">
                    <#if memo.varbranch != "">
                    <input type="checkbox" name="hq" />
                    <label for="hq" color="#000">${memo.varbranch}</label>
                    <#else>
                     ${memo.customerlabel}
                    </#if>
                  <#else>
                    <input type="checkbox" name="hq" checked/>
                    <label for="hq" color="#000">สำนักงานใหญ่</label>
                  </#if>
                  </td>
                </tr>
                <tr>
                  <td colspan="2">อ้างอิง : ${memo.customerref}</td>
                </tr>
              </table>
            </td>
          <td width="1%">
          </td>
          <td width="39%" corner-radius="5px" border="1px">
                          <table>
                <tr>
                  <td colspan="2">เลขที่ใบลดหนี้ : ${memo.transnumber}</td>
                </tr>
                <tr>
                  <td colspan="2">วันที่ : ${memo.transdate}</td>
                </tr>
                <tr>
                  <td colspan="2">อ้างอิงใบกำกับภาษี : ${memo.refnum} (${memo.duedate})</td>
                </tr>
                <tr>
                  <td colspan="2">พนักงานขาย : ${memo.salerep}</td>
                </tr>
                <tr>
                  <td colspan="2">เขตการขาย : ${memo.territories}</td>
                </tr>
                <tr>
                  <td colspan="2">สถานที่จัดส่ง : ${memo.shipto}</td>
                </tr>
              </table>
          </td>
        </tr>
    </table>
    <table height="50px" width="100%">
      <tr>
        <td>บริษัทได้รับคืนสินค้าและเครดิตบัญชีของท่านตามรายการต่อไปนี้ : -</td>
      </tr>
    </table>

<div height="100%" width="100%" border="1px" corner-radius="10px" style="z-index: -10px;">
    <#assign firstRow = 0 />
    <#assign num = 0 />
    <#assign maxRow = 9 />
    <#assign DataSize = record.item?size />
    <#assign index = 0 />
    <#list record.item as item>
    <#if item?index+1 == DataSize>
    <#assign data = record.item[firstRow..(DataSize-1)] />
  <table width="100%" height="100%" corner-radius="10px">
    <tr>
      <th width="100px" align="center" border-right="1px" padding="5px 0 2px">ลำดับ</th>
      <th width="300px" align="center" border-right="1px" padding="5px 0 2px">รหัสสินค้า / รายละเอียดสินค้า</th>
      <th width="120px" align="center" padding="5px 0 2px">รับคืน</th>
      <th width="80px" align="center" border-right="1px" padding="5px 0 2px">จำนวน</th>
      <th width="100px" align="center" border-right="1px" padding="5px 0 2px">หน่วยละ</th>
      <th width="150px" align="center" padding="5px 0 2px">จำนวนเงิน</th>
    </tr>
    <tr>
      <th width="100px" align="center" border-right="1px" padding="3px 0" border-bottom="1px">No.</th>
      <th width="300px" align="center" border-right="1px" padding="3px 0" border-bottom="1px">Code / Description</th>
      <th width="120px" align="center" style="white-space: nowrap;" padding="3px 0" border-bottom="1px">Return Goods?</th>
      <th width="80px" align="center" border-right="1px" padding="3px 0" border-bottom="1px">Quantity</th>
      <th width="100px" align="center" border-right="1px" padding="3px 0" border-bottom="1px">Unit Price</th>
      <th width="150px" align="center" padding="3px 0" border-bottom="1px">Amount</th>
    </tr>
    <#assign num = 0/>
    <#list data as items>
    <#assign num = num + 1>
    <tr height="30px">
        <td align="center" border-right="1px">${num}</td>
        <td border-right="1px">${items.displayname} ${items.description}</td>
        <td align="center"><#if memo.createdform != "">Y<#else>N</#if></td>
        <td align="center" border-right="1px">${items.quantity} ${items.units}</td>
        <td align="right" border-right="1px">${items.rate}</td>
        <td align="right">${items.amount}</td>
    </tr>
    </#list>
     <#assign leftData = 5 - data?size />
            <#if leftData gt 0>
                <#list 1..leftData as subitem>
                <tr height="30px">
        <td align="center" border-right="1px"></td>
        <td border-right="1px"></td>
        <td></td>
        <td border-right="1px"></td>
        <td align="right" border-right="1px"></td>
        <td align="right"></td>
    </tr>
                </#list>
            </#if>
  </table>

  <table width="100%" height="100%" border-top="1px">
    <tr>
      <td rowspan="7" colspan="2" width="250px">
        <table>
          <tr>
            <td width="100%">สาเหตุที่รับคืน / Reason : ${memo.remark}</td>
          </tr>
        </table>
      </td>
      <td align="left" colspan="3" width="250px">รวม</td>
      <td align="right" width="111px" border-left="1px">${memo.total}</td>
    </tr>
    <tr>
      <td colspan="3">หักส่วนลด</td>
      <td width="20%" align="right" border-left="1px">${memo.discount?number?string(",##0.00")}</td>
    </tr>
      <tr>
        <td colspan="3">จำนวนเงินสดหลังหักส่วนลด</td>
        <td align="right" border-left="1px" border-bottom="1px">${memo.afterdiscount?number?string(",##0.00")}</td>
      </tr>
      <tr>
        <td colspan="3">มูลค่าของสินค้าหรือบริการตามใบกำกับภาษีเดิม</td>
        <td align="right" border-left="1px">${memo.origamount}</td>
      </tr>
      <tr>
        <td colspan="3">มูลค่าของสินค้าหรือบริการที่ถูกต้อง</td>
        <td align="right" border-left="1px">${memo.afterorig}</td>
      </tr>
      <tr>
        <td colspan="3">ผลต่าง</td>
        <td align="right" border-left="1px">${memo.differ?number?string(",##0.00")}</td>
      </tr>
      <tr>
        <td colspan="2">จำนวนภาษีมูลค่าเพิ่ม</td>
        <td align="right">7.0%</td>
        <td align="right" border-left="1px" border-bottom="1px">${memo.taxtotal}</td>
      </tr>
      <tr>
        <td colspan="2" width="250px">(${memo.arabic})</td>
        <td colspan="3" width="250px">จำนวนเงินร่วมทั้งสิน</td>
        <td align="right" width="111px" border-left="1px">${memo.total},${memo.afterdiscount},${memo.taxtotal}</td>
      </tr>
  </table>
      
  <table width="100%" height="100%" border-top="1px">
    <tr>
      <td padding="10px 5px" colspan="2" width="100px" align="center" rowspan="2"><b>ได้รับสินค้าข้างต้นคืนแล้ว</b></td>
      <td padding="10px 5px" border-right="1px" width="150px" align="center" rowspan="2"><b>ได้เก็บสินค้าข้างต้นในคลังสินค้าแล้ว</b></td>
      <td padding="10px 0 0 37px"><b  font-size="10px">ในนาม</b></td>
    </tr>
    <tr>
      <td padding="0 5px" align="center">${memo.signname}</td>
    </tr>
    <tr>
      <td align="center" vertical-align="bottom" colspan="2">_______________</td>
      <td align="center" vertical-align="bottom" border-right="1px">_______________</td>
      <td padding="10px 5px" align="center" >_______________</td>
    </tr>
    <tr>
      <td align="center" colspan="2">แผนกรับสินค้า</td>
      <td align="center"  border-right="1px">แผนกคลังสินค้า</td>
      <td align="center" >ผู้รับมอบอำนาจ/Authorized Signature</td>
    </tr>
    <tr>
      <td align="center" colspan="2">____/____/____</td>
      <td align="center"  border-right="1px">____/____/____</td>
      <td align="center" >${memo.createdate}</td>
    </tr>
    <tr>
      <td align="center" colspan="2">วันที่/Date</td>
      <td align="center" border-right="1px">วันที่/Date</td>
      <td align="center">วันที่/Date</td>
    </tr>
  </table>
  </div>
</body>
          <#assign firstRow = maxRow + 1 />
    <#assign maxRow = maxRow + 9 />
</#if>
</#list>
</pdf>
</#list>
</pdfset>